{"ast":null,"code":"import _regeneratorRuntime from \"/home/go3rany/cipherpost/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/go3rany/cipherpost/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport Composer from './Composer.vue';\nimport MessageSum from './MessageSum.vue';\nimport axios from 'axios';\nexport default {\n  data: function data() {\n    return {\n      isComposing: false,\n      page: 1,\n      total_pages: 10,\n      // TODO:  change total pages to get from backend\n      mail_messages: [],\n      selected: []\n    };\n  },\n  components: {\n    Composer: Composer,\n    MessageSum: MessageSum\n  },\n  methods: {\n    toggleCompose: function toggleCompose() {\n      this.isComposing = !this.isComposing;\n    },\n    increment_page: function increment_page() {\n      if (this.page < this.total_pages) {\n        this.page++;\n      }\n      // TODO: request getMessage (NEED TO CHANGE PAGE NUMBERS after REQUEST)\n      this.requestGetMessages();\n    },\n    requestGetMessages: function requestGetMessages() {\n      var _this = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var host, folderId, pageId, url;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              host = \"http://localhost:8081\";\n              folderId = 1; // TODO: Replace with the actual folder ID\n              pageId = _this.page; // const sortField = 'message.timestamp';  // TODO: Get from dropdown\n              // const sortDirection = 'desc';           // TODO: direction sort \n              // const searchField = '';                 // TODO: [[criteria]]This is in search bar only\n              // const keyword = '';                     // TODO: search input\n              url = host + \"/api/messages/get/\".concat(folderId, \"?page=\").concat(pageId);\n              console.log(url);\n              console.log('getting messages..');\n              axios.get(url).then(function (response) {\n                // Handle the response data\n                console.log(response);\n                _this.mail_messages = response.data;\n                console.log('Received messages:', _this.mail_messages);\n              })[\"catch\"](function (error) {\n                // Handle errors\n                console.error('Error fetching messages:', error);\n              });\n              console.log('out');\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }))();\n    },\n    decrement_page: function decrement_page() {\n      if (this.page > 1) {\n        this.page--;\n      }\n      // TODO: request getMessage (NEED TO CHANGE PAGE NUMBERS after REQUEST)\n      this.requestGetMessages();\n    },\n    refresh: function refresh() {\n      this.requestGetMessages();\n    },\n    isSelected: function isSelected(id) {\n      return this.selected.includes(id);\n    },\n    updateSelectedItems: function updateSelectedItems(selectedId) {\n      if (this.isSelected(selectedId)) {\n        this.selected = this.selected.filter(function (id) {\n          return id !== selectedId;\n        });\n      } else {\n        this.selected.push(selectedId);\n      }\n      console.log(this.selected);\n    },\n    show_mail: function show_mail(mail_id) {\n      var required_mail = this.mail_messages.find(function (item) {\n        return item.id === mail_id;\n      });\n      this.$emit('show-mail', required_mail);\n    },\n    move: function move() {\n      this.isMoving = !this.isMoving;\n    },\n    move_to_folder: function move_to_folder() {\n      this.isMoving = !this.isMoving;\n      console.log(this.move_to);\n\n      //To Do\n\n      this.move_to = \"\";\n    },\n    requestMoveToFolder: function requestMoveToFolder() {\n      // TODO: Request to move selected messages to another folder\n    },\n    remove_to_trash: function remove_to_trash() {\n      // TODO: to delete selected messages\n      if (!this.selected || this.selected.length > 0) this.requestDeleteMessages(this.selected);\n    },\n    requestDeleteMessages: function requestDeleteMessages(selected_msgs) {\n      var _this2 = this;\n      var folderId = 1; // TODO: Replace with the actual folder ID\n      var url = \"http://localhost:8081/api/messages/delete/\".concat(folderId, \"?msg_ids=\").concat(selected_msgs.join(','));\n      console.log(selected_msgs);\n      console.log(url);\n      axios[\"delete\"](url).then(function (response) {\n        // Handle successful deletion\n        console.log('Messages deleted successfully:', response);\n        _this2.refresh();\n      })[\"catch\"](function (error) {\n        // Handle deletion error\n        console.error('Error deleting messages:', error);\n      });\n    }\n  }\n};","map":{"version":3,"names":["Composer","MessageSum","axios","data","isComposing","page","total_pages","mail_messages","selected","components","methods","toggleCompose","increment_page","requestGetMessages","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","host","folderId","pageId","url","wrap","_callee$","_context","prev","next","concat","console","log","get","then","response","error","stop","decrement_page","refresh","isSelected","id","includes","updateSelectedItems","selectedId","filter","push","show_mail","mail_id","required_mail","find","item","$emit","move","isMoving","move_to_folder","move_to","requestMoveToFolder","remove_to_trash","length","requestDeleteMessages","selected_msgs","_this2","join"],"sources":["/home/go3rany/cipherpost/src/components/Messagesview.vue"],"sourcesContent":["<template>\n    <div class=\"message_view\">\n      <div class=\"top-bar\">\n        <div class=\"left\">\n          <button @click=\"refresh\" title=\"Refresh\"><font-awesome-icon icon=\"rotate-right\" class=\"icon\"/></button>\n          <button @click=\"select_all\" title=\"Select All\"><font-awesome-icon icon=\"square-check\" class=\"icon\"/></button>\n          <button @click=\"sort\" title=\"Sort\"><font-awesome-icon icon=\"arrow-up-wide-short\" class=\"icon\"/></button>\n          <button @click=\"remove_to_trash\" title=\"Move To Trash\"><font-awesome-icon icon=\"trash-can\" class=\"icon\"/></button>\n          <button @click=\"move\" title=\"Move To Folder\"><font-awesome-icon icon=\"folder\" class=\"icon\"/></button>\n        </div>\n        <div class=\"pages\">\n          <button @click=\"decrement_page\" title=\"Back\"><font-awesome-icon icon=\"caret-left\" class=\"icon\"/></button>\n          <span>{{ page }} / {{ total_pages }}</span>\n          <button @click=\"increment_page\" title=\"Forward\"><font-awesome-icon icon=\"caret-right\" class=\"icon\"/></button>\n        </div>\n      </div>\n      <div class=\"grid-container\">\n        <MessageSum v-for=\"message in mail_messages\" :key=\"message\" @show_mail=\"show_mail\" :from=\"message.sender.username\" :subject=\"message.subject.substring(0, 32)\" :date=\"message.time\" :id=\"message.id\" :is-selected=\"isSelected(message.id)\" :priority=\"message.msg_priority\" @update:selected=\"updateSelectedItems\">\n          {{ message.content.substring(0, 100) }}\n        </MessageSum>\n      </div>\n      <button class=\"bottom-right-button\" @click=\"toggleCompose\"><font-awesome-icon icon=\"feather\" /></button>\n    </div>\n    <Composer v-if=\"isComposing\" @close_composer=\"toggleCompose\"/>\n  </template>\n  \n  <script>\n    import Composer from './Composer.vue'\n    import MessageSum from './MessageSum.vue'\n    import axios from 'axios'\n    export default{\n      data(){\n        return{\n          isComposing: false,\n          page: 1,\n          total_pages: 10,      // TODO:  change total pages to get from backend\n          mail_messages: [],\n          selected: [],\n        }\n      },\n      components: {\n        Composer,\n        MessageSum\n      },\n      methods: {\n        toggleCompose(){\n          this.isComposing = !this.isComposing\n        },\n        increment_page(){\n          if(this.page < this.total_pages){\n            this.page++\n          }\n          // TODO: request getMessage (NEED TO CHANGE PAGE NUMBERS after REQUEST)\n          this.requestGetMessages();          \n        },\n        async requestGetMessages()\n        {\n          const host = \"http://localhost:8081\"\n          const folderId = 1; // TODO: Replace with the actual folder ID\n          const pageId = this.page; \n\n          // const sortField = 'message.timestamp';  // TODO: Get from dropdown\n          // const sortDirection = 'desc';           // TODO: direction sort \n          // const searchField = '';                 // TODO: [[criteria]]This is in search bar only\n          // const keyword = '';                     // TODO: search input\n          const url = host+`/api/messages/get/${folderId}?page=${pageId}`;\n          console.log(url)\n          console.log('getting messages..');\n          axios.get(url)\n            .then(response => {\n              // Handle the response data\n              console.log(response);\n              this.mail_messages=response.data;\n              console.log('Received messages:', this.mail_messages);\n              \n            })\n            .catch(error => {\n              // Handle errors\n              console.error('Error fetching messages:', error);\n            });\n            console.log('out')\n        },\n        decrement_page(){\n          if(this.page>1){\n            this.page--;\n          }\n          // TODO: request getMessage (NEED TO CHANGE PAGE NUMBERS after REQUEST)\n          this.requestGetMessages();          \n        },\n        refresh(){\n          this.requestGetMessages();\n        },\n        isSelected(id){\n          return this.selected.includes(id)\n        },\n        updateSelectedItems(selectedId){\n          if(this.isSelected(selectedId)){\n            this.selected = this.selected.filter(id => id !== selectedId)\n          } else{\n            this.selected.push(selectedId)\n          }\n          console.log(this.selected)\n        },\n        show_mail(mail_id){\n          const required_mail = this.mail_messages.find(item => item.id === mail_id)\n          this.$emit('show-mail', required_mail)\n        },\n        move(){\n          this.isMoving = !this.isMoving\n        },\n        move_to_folder(){\n          this.isMoving = !this.isMoving\n          console.log(this.move_to)\n\n          //To Do\n\n          this.move_to = \"\"\n        },\n        requestMoveToFolder(){\n            // TODO: Request to move selected messages to another folder\n        },\n        remove_to_trash(){\n          // TODO: to delete selected messages\n          if(!this.selected || this.selected.length > 0) \n            this.requestDeleteMessages(this.selected)\n        },\n        requestDeleteMessages(selected_msgs) {\n          const folderId = 1; // TODO: Replace with the actual folder ID\n          const url = `http://localhost:8081/api/messages/delete/${folderId}?msg_ids=${selected_msgs.join(',')}`;\n          console.log(selected_msgs)\n          console.log(url)\n          axios.delete(url)\n          .then(response => {\n            // Handle successful deletion\n            console.log('Messages deleted successfully:', response);\n            this.refresh();\n          })\n          .catch(error => {\n            // Handle deletion error\n            console.error('Error deleting messages:', error);\n          });\n        },\n      },\n}\n  </script>\n  \n<style>\n  .message_view {\n    flex: 1;\n    padding: 0;\n    box-sizing: border-box;\n    background: #c8e1ee;\n    margin-top: 0.1%;\n    margin-right: 1.5%;\n    margin-bottom: 0;\n    border-top-left-radius: 20px;\n    border-top-right-radius: 20px;\n  }\n  .message_view .bottom-right-button {\n    position: fixed;\n    bottom: 4%;\n    right: 3%;\n    padding: 25px;\n    background-color: transparent;\n    color: #023047;\n    border: none;\n    border-radius: 50%;\n    cursor: pointer;\n    font-size: 25px;\n  }\n\n  .message_view .bottom-right-button:hover{\n    background-color: #FB8500;\n  }\n\n\n  .message_view .top-bar {\n    background-color: #86b0c7;\n    color: #023047;\n    padding: 0.25% 1.5% 0.25% 0.5%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    border-top-left-radius: 10px;\n    border-top-right-radius: 10px;\n  }\n\n  .message_view .top-bar .left{\n    display: flex;\n   \n  }\n\n  .message_view .top-bar .left button{\n    background: none;\n    cursor: pointer;\n    border: none;\n    padding: 8%;\n    margin: 0 6%;\n  }\n  .message_view .top-bar .left button:hover{\n    border-radius: 50%;\n    background: #FB8500\n  }\n  .message_view .top-bar .icon{\n    font-size: 18px;\n    color: #023047;\n  }\n  .message_view .top-bar .pages{\n    background: rgb(198, 237, 248);\n    padding: 0;\n    display: flex;\n    width: 8%;\n    height: auto;\n    border-radius: 20px;\n    text-align: center;\n  }\n\n  .message_view .top-bar .pages button{\n    background: none;\n    cursor: pointer;\n    border: none;\n    margin: 0 6%;\n  }\n\n  .message_view .top-bar .pages button:hover{\n    border-radius: 50%;\n    background: #FB8500\n  }\n  .message_view .top-bar .pages span{\n      margin-top: 3%;\n      width: 80%;\n  }\n\n  .grid-container {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    grid-gap: 2%;\n    padding: 1% 1%;\n  }\n\n  .grid-item {\n    width: 100%;\n    height: 10%;\n    background-color: #3498db;\n    color: #fff;\n    text-align: center;\n    line-height: 50px;\n    font-family: Arial, sans-serif;\n  }\n</style>\n  "],"mappings":";;;;;;;;;;AA2BI,OAAOA,QAAO,MAAO,gBAAe;AACpC,OAAOC,UAAS,MAAO,kBAAiB;AACxC,OAAOC,KAAI,MAAO,OAAM;AACxB,eAAc;EACZC,IAAI,WAAAA,KAAA,EAAE;IACJ,OAAM;MACJC,WAAW,EAAE,KAAK;MAClBC,IAAI,EAAE,CAAC;MACPC,WAAW,EAAE,EAAE;MAAO;MACtBC,aAAa,EAAE,EAAE;MACjBC,QAAQ,EAAE;IACZ;EACF,CAAC;EACDC,UAAU,EAAE;IACVT,QAAQ,EAARA,QAAQ;IACRC,UAAS,EAATA;EACF,CAAC;EACDS,OAAO,EAAE;IACPC,aAAa,WAAAA,cAAA,EAAE;MACb,IAAI,CAACP,WAAU,GAAI,CAAC,IAAI,CAACA,WAAU;IACrC,CAAC;IACDQ,cAAc,WAAAA,eAAA,EAAE;MACd,IAAG,IAAI,CAACP,IAAG,GAAI,IAAI,CAACC,WAAW,EAAC;QAC9B,IAAI,CAACD,IAAI,EAAC;MACZ;MACA;MACA,IAAI,CAACQ,kBAAkB,CAAC,CAAC;IAC3B,CAAC;IACKA,kBAAkB,WAAAA,mBAAA,EACxB;MAAA,IAAAC,KAAA;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,IAAA,EAAAC,QAAA,EAAAC,MAAA,EAAAC,GAAA;QAAA,OAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACQR,IAAG,GAAI,uBAAsB;cAC7BC,QAAO,GAAI,CAAC,EAAE;cACdC,MAAK,GAAIP,KAAI,CAACT,IAAI,EAExB;cACA;cACA;cACA;cACMiB,GAAE,GAAIH,IAAI,wBAAAS,MAAA,CAAsBR,QAAQ,YAAAQ,MAAA,CAASP,MAAM,CAAE;cAC/DQ,OAAO,CAACC,GAAG,CAACR,GAAG;cACfO,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;cACjC5B,KAAK,CAAC6B,GAAG,CAACT,GAAG,EACVU,IAAI,CAAC,UAAAC,QAAO,EAAK;gBAChB;gBACAJ,OAAO,CAACC,GAAG,CAACG,QAAQ,CAAC;gBACrBnB,KAAI,CAACP,aAAa,GAAC0B,QAAQ,CAAC9B,IAAI;gBAChC0B,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEhB,KAAI,CAACP,aAAa,CAAC;cAEvD,CAAC,UACK,CAAC,UAAA2B,KAAI,EAAK;gBACd;gBACAL,OAAO,CAACK,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;cAClD,CAAC,CAAC;cACFL,OAAO,CAACC,GAAG,CAAC,KAAK;YAAA;YAAA;cAAA,OAAAL,QAAA,CAAAU,IAAA;UAAA;QAAA,GAAAjB,OAAA;MAAA;IACrB,CAAC;IACDkB,cAAc,WAAAA,eAAA,EAAE;MACd,IAAG,IAAI,CAAC/B,IAAI,GAAC,CAAC,EAAC;QACb,IAAI,CAACA,IAAI,EAAE;MACb;MACA;MACA,IAAI,CAACQ,kBAAkB,CAAC,CAAC;IAC3B,CAAC;IACDwB,OAAO,WAAAA,QAAA,EAAE;MACP,IAAI,CAACxB,kBAAkB,CAAC,CAAC;IAC3B,CAAC;IACDyB,UAAU,WAAAA,WAACC,EAAE,EAAC;MACZ,OAAO,IAAI,CAAC/B,QAAQ,CAACgC,QAAQ,CAACD,EAAE;IAClC,CAAC;IACDE,mBAAmB,WAAAA,oBAACC,UAAU,EAAC;MAC7B,IAAG,IAAI,CAACJ,UAAU,CAACI,UAAU,CAAC,EAAC;QAC7B,IAAI,CAAClC,QAAO,GAAI,IAAI,CAACA,QAAQ,CAACmC,MAAM,CAAC,UAAAJ,EAAC;UAAA,OAAKA,EAAC,KAAMG,UAAU;QAAA;MAC9D,OAAM;QACJ,IAAI,CAAClC,QAAQ,CAACoC,IAAI,CAACF,UAAU;MAC/B;MACAb,OAAO,CAACC,GAAG,CAAC,IAAI,CAACtB,QAAQ;IAC3B,CAAC;IACDqC,SAAS,WAAAA,UAACC,OAAO,EAAC;MAChB,IAAMC,aAAY,GAAI,IAAI,CAACxC,aAAa,CAACyC,IAAI,CAAC,UAAAC,IAAG;QAAA,OAAKA,IAAI,CAACV,EAAC,KAAMO,OAAO;MAAA;MACzE,IAAI,CAACI,KAAK,CAAC,WAAW,EAAEH,aAAa;IACvC,CAAC;IACDI,IAAI,WAAAA,KAAA,EAAE;MACJ,IAAI,CAACC,QAAO,GAAI,CAAC,IAAI,CAACA,QAAO;IAC/B,CAAC;IACDC,cAAc,WAAAA,eAAA,EAAE;MACd,IAAI,CAACD,QAAO,GAAI,CAAC,IAAI,CAACA,QAAO;MAC7BvB,OAAO,CAACC,GAAG,CAAC,IAAI,CAACwB,OAAO;;MAExB;;MAEA,IAAI,CAACA,OAAM,GAAI,EAAC;IAClB,CAAC;IACDC,mBAAmB,WAAAA,oBAAA,EAAE;MACjB;IAAA,CACH;IACDC,eAAe,WAAAA,gBAAA,EAAE;MACf;MACA,IAAG,CAAC,IAAI,CAAChD,QAAO,IAAK,IAAI,CAACA,QAAQ,CAACiD,MAAK,GAAI,CAAC,EAC3C,IAAI,CAACC,qBAAqB,CAAC,IAAI,CAAClD,QAAQ;IAC5C,CAAC;IACDkD,qBAAqB,WAAAA,sBAACC,aAAa,EAAE;MAAA,IAAAC,MAAA;MACnC,IAAMxC,QAAO,GAAI,CAAC,EAAE;MACpB,IAAME,GAAE,gDAAAM,MAAA,CAAiDR,QAAQ,eAAAQ,MAAA,CAAY+B,aAAa,CAACE,IAAI,CAAC,GAAG,CAAC,CAAE;MACtGhC,OAAO,CAACC,GAAG,CAAC6B,aAAa;MACzB9B,OAAO,CAACC,GAAG,CAACR,GAAG;MACfpB,KAAK,UAAO,CAACoB,GAAG,EACfU,IAAI,CAAC,UAAAC,QAAO,EAAK;QAChB;QACAJ,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEG,QAAQ,CAAC;QACvD2B,MAAI,CAACvB,OAAO,CAAC,CAAC;MAChB,CAAC,UACK,CAAC,UAAAH,KAAI,EAAK;QACd;QACAL,OAAO,CAACK,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAClD,CAAC,CAAC;IACJ;EACF;AACN"},"metadata":{},"sourceType":"module","externalDependencies":[]}