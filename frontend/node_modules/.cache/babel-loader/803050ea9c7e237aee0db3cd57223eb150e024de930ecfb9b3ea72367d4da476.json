{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/go3rany/cipherpost/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.date.now.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport MessageDTO from '../../src/MessageDTO';\nimport User from '../../src/User';\nexport default {\n  data: function data() {\n    return {\n      mail_message: \"\",\n      attachements: [],\n      att_count: 0,\n      isDropdown: false,\n      recipients: \"\",\n      msg_subject: \"\",\n      msg_priority: 1 // TODO: change this to v-model like the rest\n    };\n  },\n  mounted: function mounted() {\n    document.addEventListener(\"click\", this.closeDropdown);\n  },\n  beforeDestroy: function beforeDestroy() {\n    document.removeEventListener(\"click\", this.closeDropdown);\n  },\n  methods: {\n    close: function close() {\n      this.$emit('close_composer');\n    },\n    handleTab: function handleTab(event) {\n      var textarea = event.target;\n      var start = textarea.selectionStart;\n      var end = textarea.selectionEnd;\n      this.mail_message = this.mail_message.substring(0, start) + \"\\t\" + this.mail_message.substring(end);\n      textarea.setSelectionRange(start + 1, start + 1);\n    },\n    handleFileChange: function handleFileChange(event) {\n      var file = event.target.files[0];\n      this.fileName = file.name; // Save the filename with extension\n\n      this.attachements.push(file);\n      this.att_count++;\n    },\n    formatFileSize: function formatFileSize(size) {\n      var kbSize = size / 1024;\n      if (kbSize < 1024) {\n        return kbSize.toFixed(2) + 'KB';\n      } else {\n        return (kbSize / 1024).toFixed(2) + 'MB';\n      }\n    },\n    toggleDropDown: function toggleDropDown() {\n      this.isDropdown = !this.isDropdown;\n    },\n    closeDropdown: function closeDropdown(event) {\n      var dropdownElement = this.$refs.dropdown;\n      if (dropdownElement && !dropdownElement.contains(event.target)) {\n        this.isDropdown = false;\n      }\n    },\n    remove_attachement: function remove_attachement(attachement, index) {\n      console.log(attachement);\n      this.attachements.splice(index, 1);\n    },\n    send: function send() {\n      // TODO: send message\n      sender_id = 1; //TODO: change this to actual user id\n      sender_username = \"moustafa\"; //TODO:change this to actual username\n      sender = new User(sender_username, sender_id);\n      recipients_arr = this.recipients.split(' ');\n      user_recipients = [];\n      var _iterator = _createForOfIteratorHelper(recipients_arr),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          reciever = _step.value;\n          user_recipients.push(new User(recipients_arr, 0)); // TODO: change 0 to actual id or skip\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      msg_dto = new MessageDTO(sender, user_recipients, Date.now(), this.msg_priority, this.subject, this.mail_message);\n    },\n    discard: function discard() {\n      // TODO:  save to draft\n    }\n  }\n};","map":{"version":3,"names":["MessageDTO","User","data","mail_message","attachements","att_count","isDropdown","recipients","msg_subject","msg_priority","mounted","document","addEventListener","closeDropdown","beforeDestroy","removeEventListener","methods","close","$emit","handleTab","event","textarea","target","start","selectionStart","end","selectionEnd","substring","setSelectionRange","handleFileChange","file","files","fileName","name","push","formatFileSize","size","kbSize","toFixed","toggleDropDown","dropdownElement","$refs","dropdown","contains","remove_attachement","attachement","index","console","log","splice","send","sender_id","sender_username","sender","recipients_arr","split","user_recipients","_iterator","_createForOfIteratorHelper","_step","s","n","done","reciever","value","err","e","f","msg_dto","Date","now","subject","discard"],"sources":["/home/go3rany/cipherpost/src/components/Composer.vue"],"sourcesContent":["<template>\n  <div class=\"backdrop\" @click.self=\"close\">\n    <div class=\"composer\">\n        <input v-model=\"recipients\" type=\"text\" class=\"message_attributes\" placeholder=\"Recipients\">\n        <input v-model=\"subject\" type=\"text\" class=\"message_attributes\" placeholder=\"Subject\">\n        <textarea v-model=\"mail_message\" class=\"message\" @keydown.tab.prevent=\"handleTab\" spellcheck=\"false\" placeholder=\"Type your mail message ...\"></textarea>\n        <div class=\"bottom\">\n            <div class=\"left\">\n                <button class=\"send\" title=\"Send\" @click=\"send\"><font-awesome-icon icon=\"paper-plane\" class=\"icon\"/></button>\n                <label for=\"file-input\" class=\"file-label\">\n                    <font-awesome-icon icon=\"paperclip\" class=\"icon\" title=\"Insert Attachement\"/>\n                    <input type=\"file\" id=\"file-input\" @change=\"handleFileChange\">\n                </label>\n                <button v-if=\"attachements && attachements.length>0\" class=\"send\" title=\"List Attachements\" @click.stop=\"toggleDropDown\"><font-awesome-icon icon=\"angle-up\" class=\"smaller-icon\"/></button>\n                <div class=\"dropdown_container\" @click.stop>\n                    <div v-if=\"isDropdown && attachements.length>0\" class=\"dropdown\" ref=\"dropdown\">\n                        <ul>\n                            <li v-for=\"(attachement, index) in attachements\" :key=\"index\">{{ attachement.name.substring(0,20) }}<button @click=\"remove_attachement(attachement, index)\"><font-awesome-icon icon=\"minus\"/></button></li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <button class=\"send\" title=\"Discard Draft\" @click=\"discard\"><font-awesome-icon icon=\"trash\" class=\"icon\"/></button>\n        </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport MessageDTO from '../../src/MessageDTO';\nimport User from '../../src/User';\nexport default {\n    data(){\n        return{\n            mail_message: \"\",\n            attachements: [],\n            att_count: 0,\n            isDropdown: false,\n            recipients: \"\",\n            msg_subject: \"\",\n            msg_priority: 1,// TODO: change this to v-model like the rest\n        }\n    },\n    mounted() {\n        document.addEventListener(\"click\", this.closeDropdown);\n    },\n    beforeDestroy() {\n        document.removeEventListener(\"click\", this.closeDropdown);\n    },\n    methods: {\n        close(){\n            this.$emit('close_composer');\n        },\n        handleTab(event){\n            const textarea = event.target;\n            const start = textarea.selectionStart;\n            const end = textarea.selectionEnd;\n            \n            this.mail_message = this.mail_message.substring(0, start) + \"\\t\" + this.mail_message.substring(end);\n\n            textarea.setSelectionRange(start + 1, start + 1);\n        },\n        handleFileChange(event){\n            const file= event.target.files[0];\n            \n            this.fileName = file.name; // Save the filename with extension\n            \n            this.attachements.push(file);\n            this.att_count++;\n        },\n        formatFileSize(size){\n            const kbSize = size/1024;\n            if(kbSize<1024) {\n                return kbSize.toFixed(2) + 'KB';\n            } else {\n                return (kbSize / 1024).toFixed(2) + 'MB';\n            }\n        },\n\n        toggleDropDown(){\n            this.isDropdown = !this.isDropdown;\n        },\n        closeDropdown(event) {\n            const dropdownElement = this.$refs.dropdown;\n\n            if (dropdownElement && !dropdownElement.contains(event.target)) {\n                this.isDropdown = false;\n            }\n        },\n        remove_attachement(attachement, index){\n            console.log(attachement)\n            this.attachements.splice(index, 1)\n        },\n        send() {\n            // TODO: send message\n            sender_id = 1//TODO: change this to actual user id\n            sender_username = \"moustafa\"//TODO:change this to actual username\n            sender = new User(sender_username,sender_id);\n            recipients_arr = this.recipients.split(' ');\n            user_recipients = []\n            for (reciever of recipients_arr) {\n                user_recipients.push(new User(recipients_arr, 0)); // TODO: change 0 to actual id or skip\n            }\n            msg_dto = new MessageDTO(sender,user_recipients, Date.now(), this.msg_priority,this.subject,this.mail_message,)    \n        },\n        discard(){\n            // TODO:  save to draft\n        \n        }\n    }\n}\n</script>\n\n<style>\n.backdrop {\n    top: 0;\n    position: fixed;\n    background: rgba(0,0,0,0.6);\n    width: 100%;\n    height: 100%;\n}\n\n.composer {\n    width: 40%;\n    padding: 20px 20px 30px 20px;\n    margin: 150px auto;\n    background: #d6edfa;\n    height: 55%;\n    border-radius: 10px;\n}\n.composer .message_attributes{\n    width: 100%;\n    margin-bottom: 5px;\n    border: none;\n    border-bottom: 1px solid rgba(146, 146, 146, 0.8);\n    background: none;\n}\n\n.composer .message{\n    width:100%;\n    height: 82%;\n    margin-top: 15px;\n    margin-bottom: 0.5%;\n    text-align: left;\n    background: none;\n    border: none;\n    border-bottom: 1px solid rgba(146, 146, 146, 0.8);\n    border-left: 1px solid rgba(146, 146, 146, 0.8);\n    resize: none;\n    overflow-y: auto;\n}\n\n.composer .bottom{\n    display: flex;\n    justify-content: space-between;\n}\n.composer .left{\n    display: flex;\n}\n.composer .send{\n    margin-left: 0;\n    height: 40px;\n    width: 40px;\n    background: none;\n    border: none;\n    cursor: pointer;\n    color: #023047;\n}\n\n.composer .send:hover{\n    border-radius: 50%;\n    background-color: #FB8500\n}\n.composer .icon{\n    font-size: 20px;\n}\n\n.composer .file-label{\n    padding: 10px 12px;\n    background: none;\n    border: none;\n    cursor: pointer;\n    color: #023047;\n}\n.composer .file-label:hover{\n    border-radius: 50%;\n    background-color: #FB8500\n}\n.composer .smaller-icon{\n    font-size: 16px;\n    color: #023047;\n}\n.composer .bottom input[type=\"file\"]{\n    display :none;\n}\n\n.composer .dropdown_container{\n    position: relative;\n    right: 16%;\n    bottom: 95%\n}\n.composer .dropdown_container .dropdown{\n    background: #f7e8c7;\n    border: 1px solid #023047;\n    border-radius: 3%;\n    padding: 0;\n    width: 180px;\n}\n.dropdown ul{\n    padding-left: 10%;\n    list-style: none;\n    color: #023047;\n}\n.dropdown ul li{\n    display: flex;\n    justify-content: space-between;\n    font-size: 12px;\n    text-align: left;\n}\n.dropdown ul li button{\n    background: none;\n    border: none;\n    cursor: pointer;\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}