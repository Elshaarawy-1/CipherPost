{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Composer from './Composer.vue';\nimport MessageSum from './MessageSum.vue';\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      isComposing: false,\n      isMoving: false,\n      page: 1,\n      move_to: \"\",\n      total_pages: 10,\n      mail_messages: [],\n      selected: []\n    };\n  },\n  components: {\n    Composer,\n    MessageSum\n  },\n  methods: {\n    toggleCompose() {\n      this.isComposing = !this.isComposing;\n    },\n    increment_page() {\n      if (this.page < this.total_pages) {\n        this.page++;\n      }\n      this.requestGetMessages();\n    },\n    decrement_page() {\n      if (this.page > 1) {\n        this.page--;\n      }\n      this.requestGetMessages();\n    },\n    async requestGetMessages() {\n      const host = \"http://172.20.10.4:8081\";\n      const folderId = 1; // TODO: Replace with the actual folder ID\n      const pageId = this.page;\n\n      // const sortField = 'message.timestamp';  // TODO: Get from dropdown\n      // const sortDirection = 'desc';           // TODO: direction sort \n      // const searchField = '';                 // TODO: [[criteria]]This is in search bar only\n      // const keyword = '';                     // TODO: search input\n      const url = host + `/api/messages/get/${folderId}?page=${pageId - 1}`;\n      console.log(url);\n      console.log('getting messages..');\n      axios.get(url).then(response => {\n        // Handle the response data\n        console.log(response);\n        this.mail_messages = response.data;\n        console.log('Received messages:', this.mail_messages);\n      }).catch(error => {\n        // Handle errors\n        console.error('Error fetching messages:', error);\n      });\n      console.log('out');\n    },\n    isSelected(id) {\n      return this.selected.includes(id);\n    },\n    updateSelectedItems(selectedId) {\n      if (this.isSelected(selectedId)) {\n        this.selected = this.selected.filter(id => id !== selectedId);\n      } else {\n        this.selected.push(selectedId);\n      }\n      console.log(this.selected);\n    },\n    show_mail(mail_id) {\n      const required_mail = this.mail_messages.find(item => item.id === mail_id);\n      console.log(required_mail);\n      this.$emit('show-mail', required_mail);\n    },\n    move() {\n      this.isMoving = !this.isMoving;\n    },\n    move_to_folder() {\n      this.isMoving = !this.isMoving;\n      console.log(this.move_to);\n\n      //To Do\n\n      this.move_to = \"\";\n    },\n    remove_to_trash() {\n      // TODO: to delete selected messages\n      if (!this.selected || this.selected.length > 0) this.requestDeleteMessages(this.selected);\n    },\n    async requestDeleteMessages(selected_msgs) {\n      const folderId = 1; // TODO: Replace with the actual folder ID\n      const url = `http://172.20.10.4:8081/api/messages/delete/${folderId}?msg_ids=${selected_msgs.join(',')}`;\n      console.log(selected_msgs);\n      console.log(url);\n      axios.delete(url).then(response => {\n        // Handle successful deletion\n        console.log('Messages deleted successfully:', response);\n        this.refresh();\n      }).catch(error => {\n        // Handle deletion error\n        console.error('Error deleting messages:', error);\n      });\n    },\n    refresh() {\n      this.selected = [];\n      this.requestGetMessages();\n    }\n  }\n};","map":{"version":3,"names":["Composer","MessageSum","axios","data","isComposing","isMoving","page","move_to","total_pages","mail_messages","selected","components","methods","toggleCompose","increment_page","requestGetMessages","decrement_page","host","folderId","pageId","url","console","log","get","then","response","catch","error","isSelected","id","includes","updateSelectedItems","selectedId","filter","push","show_mail","mail_id","required_mail","find","item","$emit","move","move_to_folder","remove_to_trash","length","requestDeleteMessages","selected_msgs","join","delete","refresh"],"sources":["/home/moustafa/Me/Projects/Mail/vault_mail/src/components/Messagesview.vue"],"sourcesContent":["<template>\n  <div class=\"message_view\">\n    <div class=\"option_bar\">\n      <div class=\"left\">\n        <button @click=\"refresh\" title=\"Refresh\"><font-awesome-icon icon=\"rotate-right\" class=\"icon\"/></button>\n        <button @click=\"select_all\" title=\"Select All\"><font-awesome-icon icon=\"square-check\" class=\"icon\"/></button>\n        <button @click=\"sort\" title=\"Sort\"><font-awesome-icon icon=\"arrow-up-wide-short\" class=\"icon\"/></button>\n        <button @click=\"remove_to_trash\" title=\"Move To Trash\"><font-awesome-icon icon=\"trash-can\" class=\"icon\"/></button>\n        <button @click=\"move\" title=\"Move To Folder \"><font-awesome-icon icon=\"folder\" class=\"icon\"/></button>\n        <div class=\"dropdown_container\">\n          <div v-if=\"isMoving\" class=\"dropdown\" ref=\"dropdown\">\n            <input type=\"text\" v-model=\"move_to\" placeholder=\"Enter Destination Folder\" @keyup.enter=\"move_to_folder\"/>\n          </div>\n      </div>\n      </div>\n      <div class=\"pages\">\n        <button @click=\"decrement_page\" title=\"Back\"><font-awesome-icon icon=\"caret-left\" class=\"icon\"/></button>\n        <span>{{ page }} / {{ total_pages }}</span>\n        <button @click=\"increment_page\" title=\"Forward\"><font-awesome-icon icon=\"caret-right\" class=\"icon\"/></button>\n      </div>\n    </div>\n    <div class=\"grid-container\">\n      <MessageSum v-for=\"message in mail_messages\" :key=\"message\" @show_mail=\"show_mail\" :from=\"message.sender.username\" :subject=\"message.subject.substring(0, 32)\" :date=\"message.time\" :id=\"message.id\" :is-selected=\"isSelected(message.id)\" :priority=\"message.msg_priority\" @update:selected=\"updateSelectedItems\">\n        {{ message.content.substring(0, 100) }}\n      </MessageSum>\n    </div>\n    <button class=\"bottom-right-button\" @click=\"toggleCompose\"><font-awesome-icon icon=\"feather\" /></button>\n  </div>\n  <Composer v-if=\"isComposing\" @close_composer=\"toggleCompose\"/>\n</template>\n\n<script>\n  import Composer from './Composer.vue'\n  import MessageSum from './MessageSum.vue'\n  import axios from 'axios'\n  export default{\n    data(){\n      return{\n        isComposing: false,\n        isMoving: false,\n        page: 1,\n        move_to:\"\",\n        total_pages: 10,\n        mail_messages: [],\n        selected: [],\n      }\n    },\n    components: {\n      Composer,\n      MessageSum\n    },\n    methods: {\n      toggleCompose(){\n        this.isComposing = !this.isComposing\n      },\n      increment_page(){\n        if(this.page < this.total_pages){\n          this.page++\n        }\n        this.requestGetMessages();          \n      },\n      decrement_page(){\n        if(this.page>1){\n          this.page--;\n        }\n        this.requestGetMessages();          \n      },\n      async requestGetMessages()\n      {\n        const host = \"http://172.20.10.4:8081\"\n        const folderId = 1; // TODO: Replace with the actual folder ID\n        const pageId = this.page; \n\n        // const sortField = 'message.timestamp';  // TODO: Get from dropdown\n        // const sortDirection = 'desc';           // TODO: direction sort \n        // const searchField = '';                 // TODO: [[criteria]]This is in search bar only\n        // const keyword = '';                     // TODO: search input\n        const url = host+`/api/messages/get/${folderId}?page=${pageId-1}`;\n        console.log(url)\n        console.log('getting messages..');\n        axios.get(url)\n          .then(response => {\n            // Handle the response data\n            console.log(response);\n            this.mail_messages=response.data;\n            console.log('Received messages:', this.mail_messages);\n            \n          })\n          .catch(error => {\n            // Handle errors\n            console.error('Error fetching messages:', error);\n          });\n          console.log('out')\n      },\n      isSelected(id){\n        return this.selected.includes(id)\n      },\n      updateSelectedItems(selectedId){\n        if(this.isSelected(selectedId)){\n          this.selected = this.selected.filter(id => id !== selectedId)\n        } else{\n          this.selected.push(selectedId)\n        }\n        console.log(this.selected)\n      },\n      show_mail(mail_id){\n        const required_mail = this.mail_messages.find(item => item.id === mail_id)\n        console.log(required_mail)\n        this.$emit('show-mail', required_mail)\n      },\n      move(){\n        this.isMoving = !this.isMoving\n      },\n      move_to_folder(){\n        this.isMoving = !this.isMoving\n        console.log(this.move_to)\n\n        //To Do\n\n        this.move_to = \"\"\n      },\n      remove_to_trash(){\n        // TODO: to delete selected messages\n        if(!this.selected || this.selected.length > 0) \n          this.requestDeleteMessages(this.selected)\n      },\n      async requestDeleteMessages(selected_msgs) {\n        const folderId = 1; // TODO: Replace with the actual folder ID\n        const url = `http://172.20.10.4:8081/api/messages/delete/${folderId}?msg_ids=${selected_msgs.join(',')}`;\n        console.log(selected_msgs)\n        console.log(url)\n        axios.delete(url)\n        .then(response => {\n          // Handle successful deletion\n          console.log('Messages deleted successfully:', response);\n          this.refresh();\n        })\n        .catch(error => {\n          // Handle deletion error\n          console.error('Error deleting messages:', error);\n        });\n      },\n      refresh(){\n        this.selected = []\n        this.requestGetMessages();\n      },\n    },\n}\n</script>\n\n<style>\n.message_view {\n  flex: 1;\n  padding: 0;\n  box-sizing: border-box;\n  background: #c8e1ee;\n  margin-top: 0.1%;\n  margin-right: 1.5%;\n  margin-bottom: 0;\n  border-top-left-radius: 20px;\n  border-top-right-radius: 20px;\n}\n.message_view .bottom-right-button {\n  position: fixed;\n  bottom: 4%;\n  right: 3%;\n  padding: 25px;\n  background-color: transparent;\n  color: #023047;\n  border: none;\n  border-radius: 50%;\n  cursor: pointer;\n  font-size: 25px;\n}\n\n.message_view .bottom-right-button:hover{\n  background-color: #FB8500;\n}\n\n\n.message_view .option_bar {\n  background-color: #86b0c7;\n  color: #023047;\n  padding: 0.25% 1.5% 0.25% 0.5%;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-top-left-radius: 10px;\n  border-top-right-radius: 10px;\n}\n\n.message_view .option_bar .left{\n  display: flex;\n \n}\n\n.message_view .option_bar .left button{\n  background: none;\n  cursor: pointer;\n  border: none;\n  padding: 8%;\n  margin: 0 6%;\n}\n.message_view .option_bar .left button:hover{\n  border-radius: 50%;\n  background: #FB8500\n}\n.message_view .option_bar .icon{\n  font-size: 18px;\n  color: #023047;\n}\n.message_view .option_bar .pages{\n  background: rgb(198, 237, 248);\n  padding: 0;\n  display: flex;\n  width: 8%;\n  height: auto;\n  border-radius: 20px;\n  text-align: center;\n}\n\n.message_view .option_bar .pages button{\n  background: none;\n  cursor: pointer;\n  border: none;\n  margin: 0 6%;\n}\n\n.message_view .option_bar .pages button:hover{\n  border-radius: 50%;\n  background: #FB8500\n}\n.message_view .option_bar .pages span{\n    margin-top: 3%;\n    width: 80%;\n}\n\n.grid-container {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  grid-gap: 2%;\n  padding: 1% 1%;\n}\n\n.grid-item {\n  width: 100%;\n  height: 10%;\n  background-color: #3498db;\n  color: #fff;\n  text-align: center;\n  line-height: 50px;\n  font-family: Arial, sans-serif;\n}\n\n.option_bar .dropdown_container{\n  position: absolute;\n  top: 12%;\n  left: 25%;\n}\n.option_bar .dropdown_container .dropdown input{\nheight: 30px;\nwidth: auto;\nfont-size: 16px;\n\n}\n</style>"],"mappings":";AAgCE,OAAOA,QAAO,MAAO,gBAAe;AACpC,OAAOC,UAAS,MAAO,kBAAiB;AACxC,OAAOC,KAAI,MAAO,OAAM;AACxB,eAAc;EACZC,IAAIA,CAAA,EAAE;IACJ,OAAM;MACJC,WAAW,EAAE,KAAK;MAClBC,QAAQ,EAAE,KAAK;MACfC,IAAI,EAAE,CAAC;MACPC,OAAO,EAAC,EAAE;MACVC,WAAW,EAAE,EAAE;MACfC,aAAa,EAAE,EAAE;MACjBC,QAAQ,EAAE;IACZ;EACF,CAAC;EACDC,UAAU,EAAE;IACVX,QAAQ;IACRC;EACF,CAAC;EACDW,OAAO,EAAE;IACPC,aAAaA,CAAA,EAAE;MACb,IAAI,CAACT,WAAU,GAAI,CAAC,IAAI,CAACA,WAAU;IACrC,CAAC;IACDU,cAAcA,CAAA,EAAE;MACd,IAAG,IAAI,CAACR,IAAG,GAAI,IAAI,CAACE,WAAW,EAAC;QAC9B,IAAI,CAACF,IAAI,EAAC;MACZ;MACA,IAAI,CAACS,kBAAkB,CAAC,CAAC;IAC3B,CAAC;IACDC,cAAcA,CAAA,EAAE;MACd,IAAG,IAAI,CAACV,IAAI,GAAC,CAAC,EAAC;QACb,IAAI,CAACA,IAAI,EAAE;MACb;MACA,IAAI,CAACS,kBAAkB,CAAC,CAAC;IAC3B,CAAC;IACD,MAAMA,kBAAkBA,CAAA,EACxB;MACE,MAAME,IAAG,GAAI,yBAAwB;MACrC,MAAMC,QAAO,GAAI,CAAC,EAAE;MACpB,MAAMC,MAAK,GAAI,IAAI,CAACb,IAAI;;MAExB;MACA;MACA;MACA;MACA,MAAMc,GAAE,GAAIH,IAAI,GAAE,qBAAoBC,QAAS,SAAQC,MAAM,GAAC,CAAE,EAAC;MACjEE,OAAO,CAACC,GAAG,CAACF,GAAG;MACfC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;MACjCpB,KAAK,CAACqB,GAAG,CAACH,GAAG,EACVI,IAAI,CAACC,QAAO,IAAK;QAChB;QACAJ,OAAO,CAACC,GAAG,CAACG,QAAQ,CAAC;QACrB,IAAI,CAAChB,aAAa,GAACgB,QAAQ,CAACtB,IAAI;QAChCkB,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAACb,aAAa,CAAC;MAEvD,CAAC,EACAiB,KAAK,CAACC,KAAI,IAAK;QACd;QACAN,OAAO,CAACM,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAClD,CAAC,CAAC;MACFN,OAAO,CAACC,GAAG,CAAC,KAAK;IACrB,CAAC;IACDM,UAAUA,CAACC,EAAE,EAAC;MACZ,OAAO,IAAI,CAACnB,QAAQ,CAACoB,QAAQ,CAACD,EAAE;IAClC,CAAC;IACDE,mBAAmBA,CAACC,UAAU,EAAC;MAC7B,IAAG,IAAI,CAACJ,UAAU,CAACI,UAAU,CAAC,EAAC;QAC7B,IAAI,CAACtB,QAAO,GAAI,IAAI,CAACA,QAAQ,CAACuB,MAAM,CAACJ,EAAC,IAAKA,EAAC,KAAMG,UAAU;MAC9D,OAAM;QACJ,IAAI,CAACtB,QAAQ,CAACwB,IAAI,CAACF,UAAU;MAC/B;MACAX,OAAO,CAACC,GAAG,CAAC,IAAI,CAACZ,QAAQ;IAC3B,CAAC;IACDyB,SAASA,CAACC,OAAO,EAAC;MAChB,MAAMC,aAAY,GAAI,IAAI,CAAC5B,aAAa,CAAC6B,IAAI,CAACC,IAAG,IAAKA,IAAI,CAACV,EAAC,KAAMO,OAAO;MACzEf,OAAO,CAACC,GAAG,CAACe,aAAa;MACzB,IAAI,CAACG,KAAK,CAAC,WAAW,EAAEH,aAAa;IACvC,CAAC;IACDI,IAAIA,CAAA,EAAE;MACJ,IAAI,CAACpC,QAAO,GAAI,CAAC,IAAI,CAACA,QAAO;IAC/B,CAAC;IACDqC,cAAcA,CAAA,EAAE;MACd,IAAI,CAACrC,QAAO,GAAI,CAAC,IAAI,CAACA,QAAO;MAC7BgB,OAAO,CAACC,GAAG,CAAC,IAAI,CAACf,OAAO;;MAExB;;MAEA,IAAI,CAACA,OAAM,GAAI,EAAC;IAClB,CAAC;IACDoC,eAAeA,CAAA,EAAE;MACf;MACA,IAAG,CAAC,IAAI,CAACjC,QAAO,IAAK,IAAI,CAACA,QAAQ,CAACkC,MAAK,GAAI,CAAC,EAC3C,IAAI,CAACC,qBAAqB,CAAC,IAAI,CAACnC,QAAQ;IAC5C,CAAC;IACD,MAAMmC,qBAAqBA,CAACC,aAAa,EAAE;MACzC,MAAM5B,QAAO,GAAI,CAAC,EAAE;MACpB,MAAME,GAAE,GAAK,+CAA8CF,QAAS,YAAW4B,aAAa,CAACC,IAAI,CAAC,GAAG,CAAE,EAAC;MACxG1B,OAAO,CAACC,GAAG,CAACwB,aAAa;MACzBzB,OAAO,CAACC,GAAG,CAACF,GAAG;MACflB,KAAK,CAAC8C,MAAM,CAAC5B,GAAG,EACfI,IAAI,CAACC,QAAO,IAAK;QAChB;QACAJ,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEG,QAAQ,CAAC;QACvD,IAAI,CAACwB,OAAO,CAAC,CAAC;MAChB,CAAC,EACAvB,KAAK,CAACC,KAAI,IAAK;QACd;QACAN,OAAO,CAACM,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAClD,CAAC,CAAC;IACJ,CAAC;IACDsB,OAAOA,CAAA,EAAE;MACP,IAAI,CAACvC,QAAO,GAAI,EAAC;MACjB,IAAI,CAACK,kBAAkB,CAAC,CAAC;IAC3B;EACF;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}